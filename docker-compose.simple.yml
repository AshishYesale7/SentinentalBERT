version: '3.8'

services:
  # Simple Enhanced Dashboard
  enhanced-dashboard:
    build:
      context: .
      dockerfile: Dockerfile.simple
    container_name: sentinelbert-simple-dashboard
    environment:
      - PYTHONPATH=/app
      - STREAMLIT_SERVER_PORT=8501
      - STREAMLIT_SERVER_ADDRESS=0.0.0.0
      - STREAMLIT_SERVER_ENABLE_CORS=true
      - STREAMLIT_SERVER_ENABLE_XSRF_PROTECTION=false
      - STREAMLIT_BROWSER_GATHER_USAGE_STATS=false
      - STREAMLIT_SERVER_HEADLESS=true
      
      # Twitter API Configuration
      - TWITTER_BEARER_TOKEN=AAAAAAAAAAAAAAAAAAAAAHsN4QEAAAAA8%2BZQa%2BzllARQxtAvmhCQsA0WQCs%3DpF9thH1ztd85xkbAsWZvubIgJ98edZ3z7BdA8q1vfkRHnBMd6B
      
      # Development Configuration
      - LOG_LEVEL=INFO
      - DEBUG_MODE=true
    
    volumes:
      - .:/app
      - ./data:/app/data
      - ./logs:/app/logs
    
    ports:
      - "8501:8501"    # Streamlit dashboard
      - "12000:12000"  # Alternative port
    
    working_dir: /app
    
    command: streamlit run enhanced_dashboard_integrated.py --server.port 8501 --server.address 0.0.0.0 --server.enableCORS true --server.enableXsrfProtection false
    
    restart: unless-stopped
    
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8501/_stcore/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s

networks:
  default:
    driver: bridge