# =============================================================================
# GitHub Pages Configuration for SentinelBERT Documentation
# =============================================================================
# 
# This workflow configures GitHub Pages settings and ensures proper deployment
# of the AI-generated documentation website.
# 
# =============================================================================

name: ⚙️ Configure GitHub Pages

on:
  workflow_dispatch:
  push:
    branches: [ main ]
    paths:
      - '.github/workflows/pages-config.yml'

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  configure-pages:
    name: ⚙️ Configure GitHub Pages Settings
    runs-on: ubuntu-latest
    
    steps:
      - name: 📥 Checkout Repository
        uses: actions/checkout@v4
      
      - name: ⚙️ Configure Pages Settings
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            try {
              // Enable GitHub Pages
              await github.rest.repos.createPagesSite({
                owner: context.repo.owner,
                repo: context.repo.repo,
                source: {
                  branch: 'main',
                  path: '/'
                }
              });
              console.log('✅ GitHub Pages enabled successfully');
            } catch (error) {
              if (error.status === 409) {
                console.log('ℹ️ GitHub Pages already enabled');
              } else {
                console.log('❌ Error enabling GitHub Pages:', error.message);
              }
            }
            
            // Get Pages info
            try {
              const pages = await github.rest.repos.getPages({
                owner: context.repo.owner,
                repo: context.repo.repo
              });
              console.log('📄 Pages URL:', pages.data.html_url);
              console.log('🔧 Pages Status:', pages.data.status);
            } catch (error) {
              console.log('❌ Error getting Pages info:', error.message);
            }
      
      - name: 📊 Summary
        run: |
          echo "## ⚙️ GitHub Pages Configuration" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "✅ **Status**: GitHub Pages configured for documentation deployment" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### 🌐 Documentation Website" >> $GITHUB_STEP_SUMMARY
          echo "- **URL**: https://nano-b-o-t.github.io/SentinentalBERT/" >> $GITHUB_STEP_SUMMARY
          echo "- **Source**: GitHub Actions workflow" >> $GITHUB_STEP_SUMMARY
          echo "- **Auto-Deploy**: Enabled on documentation changes" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### 📚 Available Documentation" >> $GITHUB_STEP_SUMMARY
          echo "- Project Overview & Quick Start" >> $GITHUB_STEP_SUMMARY
          echo "- Complete Deployment Guide" >> $GITHUB_STEP_SUMMARY
          echo "- System Architecture & Design" >> $GITHUB_STEP_SUMMARY
          echo "- Executive Summary & Business Case" >> $GITHUB_STEP_SUMMARY
          echo "- AI-Generated Code Documentation" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### 🚀 Next Steps" >> $GITHUB_STEP_SUMMARY
          echo "1. Documentation will be automatically deployed when files change" >> $GITHUB_STEP_SUMMARY
          echo "2. AI Documentation Generator will create enhanced docs" >> $GITHUB_STEP_SUMMARY
          echo "3. Website will be updated with beautiful, searchable interface" >> $GITHUB_STEP_SUMMARY